<div class="col-md-12">
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">Add New Album</h3>
        </div>
        <div class="card-body register-card-body">

        </div>
        <div class="card-footer">

            <button type="button" id="btnAddAlbum" class="btn btn-success">Add Album</button>
            <a asp-area="Administration" class="btn btn-danger" asp-controller="NewPageFooter" asp-action="Create">Clear</a>
            <a asp-area="Administration" class="btn btn-primary" asp-controller="NewPageFooter" asp-action="Index">List</a>
        </div>
    </div>
</div>


<div class="modal fade" id="modal-lg" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">

                    <i class="fas fa-history"></i> Add Album
                </h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div id="AlbumDetails" style="height:350px;overflow-y:auto;" class="modal-body">
            </div>
            <div class="modal-footer justify-content-between">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>

            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>

<script>
    $(document).ready(function () {
        $("#btnAddAlbum").click(function () {

            if ($("#BugDetailViewModel_BugId").val() != "") {
                var jsonObject =
                {
                    BugId: $("#BugDetailViewModel_BugId").val()
                };

                $("#loader").show();

                $.ajax({
                    type: "POST",
                    url: "/Administration/Album/GetAlbumView",
                    dataType: "html",
                    data: jsonObject,

                    success: function (data, textStatus, xhr) {
                        if (data.length != 0) {

                            $("#AlbumDetails").html(data);
                            $("#modal-lg").modal('show');

                            $("#loader").hide();
                        }
                    },
                    error: function (xhr, status, err) {
                        if (xhr.status == 400) {
                            DisplayModelStateErrors(xhr.responseJSON.ModelState);
                        }
                    }
                });

            }

        });


        $(document).on("click", "#btnsubmit", function (event) {
            if ($("#AlbumName").val() == "") {
                $.alert({
                    title: 'Validation!',
                    content: 'Enter Album Name',
                    type: 'red'
                });
            }
            else if ($("#AlbumNameLL").val() == "") {
                $.alert({
                    title: 'Validation!',
                    content: 'Enter Album Name in Other',
                    type: 'red'
                });

            }
            else {


                var jsonObject =
                {
                    AlbumName: $("#AlbumName").val(),
                    AlbumNameLL: $("#AlbumNameLL").val(),
                    IsActive: $("input:checkbox:checked").val()

                };

                $("#loader").show();

                $.ajax({
                    type: "POST",
                    url: "/Administration/Album/Create",
                    dataType: "html",
                    data: jsonObject,

                    success: function (data, textStatus, xhr)
                    {
                        if (data.Result == "success")
                        {
                            window.location.reload();
                        }
                    },
                    error: function (xhr, status, err) {
                        if (xhr.status == 400) {
                            DisplayModelStateErrors(xhr.responseJSON.ModelState);
                        }
                    }
                });

            }
        });



    });
    function DisplayModelStateErrors(modelState) {
        var message = "";
        var propStrings = Object.keys(modelState);

        $.each(propStrings, function (i, propString) {
            var propErrors = modelState[propString];
            $.each(propErrors, function (j, propError) {
                message += propError;
            });
            message += "\n";
        });

        alert(message);
    };
</script>